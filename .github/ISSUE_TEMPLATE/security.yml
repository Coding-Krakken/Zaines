name: Security Issue
description: Report a security vulnerability or security enhancement
title: "security(<component>): <brief description>"
labels:
  - security
  - triage
body:
  - type: markdown
    attributes:
      value: |
        ## ⚠️ Security Issue
        
        **IMPORTANT:** If this is a critical vulnerability, please report it **privately** via GitHub Security Advisories or email the security team directly.
        
        For security policy, see [SECURITY.md](../SECURITY.md).

  - type: dropdown
    id: type
    attributes:
      label: Issue Type
      description: Is this a vulnerability or an enhancement?
      options:
        - Vulnerability (Security Flaw)
        - Enhancement (Security Improvement)
        - Audit Finding
        - Compliance Requirement
    validations:
      required: true

  - type: dropdown
    id: severity
    attributes:
      label: Severity (CVSS Score Context)
      description: How severe is this security issue?
      options:
        - Critical (CVSS 9.0-10.0)
        - High (CVSS 7.0-8.9)
        - Medium (CVSS 4.0-6.9)
        - Low (CVSS 0.1-3.9)
        - Informational
    validations:
      required: true

  - type: dropdown
    id: priority
    attributes:
      label: Priority
      options:
        - P0 (Fix Immediately)
        - P1 (Fix This Sprint)
        - P2 (Fix Soon)
        - P3 (Track for Later)
    validations:
      required: true

  - type: input
    id: component
    attributes:
      label: Component
      description: Which component is affected?
      placeholder: component:
    validations:
      required: true

  - type: textarea
    id: summary
    attributes:
      label: Security Issue Summary
      description: Brief description of the security issue
      placeholder: One-line summary (avoid sensitive details in title/summary for public repos)
    validations:
      required: true

  - type: textarea
    id: threat-description
    attributes:
      label: Threat Description
      description: Describe the security threat or vulnerability
      placeholder: |
        **What is the vulnerability?**
        
        **What attack vector is exposed?**
        
        **What could an attacker do?**
    validations:
      required: true

  - type: textarea
    id: impact
    attributes:
      label: Impact Assessment
      description: What is the potential impact if exploited?
      placeholder: |
        **Confidentiality Impact:**
        - [ ] No impact
        - [ ] Limited disclosure
        - [ ] Significant disclosure

        **Integrity Impact:**
        - [ ] No impact
        - [ ] Limited modification
        - [ ] Significant modification

        **Availability Impact:**
        - [ ] No impact
        - [ ] Limited disruption
        - [ ] Significant disruption

        **Scope:**
        - Number of users affected:
        - Data at risk:
        - Business impact:
    validations:
      required: true

  - type: textarea
    id: affected-versions
    attributes:
      label: Affected Versions
      description: Which versions/environments are affected?
      placeholder: |
        - Versions:
        - Environments:
        - Browsers (if applicable):

  - type: textarea
    id: repro-steps
    attributes:
      label: Steps to Reproduce (Proof of Concept)
      description: How can this be demonstrated? (Be careful with public disclosure)
      placeholder: |
        1. 
        2. 
        3. 
        
        **Note:** Sensitive POC details should be shared privately.

  - type: textarea
    id: current-mitigations
    attributes:
      label: Current Mitigations / Workarounds
      description: Are there any temporary mitigations in place?
      placeholder: |
        **Existing Controls:**
        - 

        **Temporary Workarounds:**
        - 

  - type: textarea
    id: proposed-solution
    attributes:
      label: Proposed Solution / Remediation
      description: How should this be fixed?
      placeholder: |
        **Short-term Fix:**
        - 

        **Long-term Solution:**
        - 

        **Additional Security Controls:**
        - 
    validations:
      required: true

  - type: textarea
    id: acceptance-criteria
    attributes:
      label: Acceptance Criteria (Fix Validation)
      description: How will we verify the fix?
      placeholder: |
        - [ ] Vulnerability no longer exploitable
        - [ ] Security tests added
        - [ ] Penetration testing performed
        - [ ] Security review complete
        - [ ] No regression to existing security controls
    validations:
      required: true

  - type: textarea
    id: test-plan
    attributes:
      label: Security Test Plan
      description: How should this be tested?
      placeholder: |
        **Unit Tests:**
        - 

        **Security Tests:**
        - 

        **Penetration Tests:**
        - 

        **Fuzzing:**
        - 

  - type: textarea
    id: owasp
    attributes:
      label: OWASP Classification
      description: Which OWASP Top 10 category?
      placeholder: |
        - [ ] A01:2021 – Broken Access Control
        - [ ] A02:2021 – Cryptographic Failures
        - [ ] A03:2021 – Injection
        - [ ] A04:2021 – Insecure Design
        - [ ] A05:2021 – Security Misconfiguration
        - [ ] A06:2021 – Vulnerable and Outdated Components
        - [ ] A07:2021 – Identification and Authentication Failures
        - [ ] A08:2021 – Software and Data Integrity Failures
        - [ ] A09:2021 – Security Logging and Monitoring Failures
        - [ ] A10:2021 – Server-Side Request Forgery (SSRF)
        - [ ] Other/Not Applicable

  - type: textarea
    id: cve
    attributes:
      label: CVE / External References
      description: Any CVEs, CWEs, or external references?
      placeholder: |
        - CVE:
        - CWE:
        - References:

  - type: textarea
    id: rollout
    attributes:
      label: Rollout / Disclosure Plan
      description: How should the fix be deployed and disclosed?
      placeholder: |
        **Deployment Strategy:**
        - [ ] Emergency hotfix
        - [ ] Regular release cycle
        - [ ] Gradual rollout

        **Disclosure Timeline:**
        - Private fix first, then public disclosure (responsible disclosure)
        - Coordinate with security team

        **Customer Notification:**
        - 

  - type: checkboxes
    id: checklist
    attributes:
      label: Security Issue Checklist
      options:
        - label: I have assessed the severity and impact
          required: true
        - label: I have proposed a remediation approach
          required: true
        - label: I have considered security test requirements
          required: true
        - label: I understand this may require private handling before public disclosure
          required: true
